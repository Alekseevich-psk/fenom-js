"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const e=require("path"),t=require("fs/promises"),r=[...[{type:"extends",regex:/^\{extends\s+['"]file:([^'"]+)['"]\s*\}/,process:e=>({file:e[1]})},{type:"block_open",regex:/^\{block\s+(['"])(.*?)\1\s*\}/,process:e=>({name:e[2]})},{type:"block_close",regex:/^\{\/block\}/},{type:"parent",regex:/^\{parent\}/},{type:"paste",regex:/^\{paste\s+(['"])(.*?)\1\}/,process:e=>({name:e[2]})},{type:"use",regex:/^\{use\s+(['"])(.*?)\1\}/,process:e=>({file:e[2]})}],{type:"include",regex:/^\{include\s+['"]file:([^'"]+)['"](?:\s+((?:\s*\w+\s*=\s*(?:"[^"]*"|'[^']*'|[^\s}]+))+))?\s*\}/,process:e=>{const t=e[1],r=e[2],s={};if(r){const e=/(\w+)\s*=\s*(?:"([^"]*)"|'([^']*)'|([^\s}]+))/g;let t;for(;null!==(t=e.exec(r));){const e=t[1],r=t[2]||t[3]||t[4]||"";s[e]=r}}return{file:t,params:s}}},...[{type:"for_range",regex:/^\{(for|foreach)\s+(\d+)\.\.(\d+)\s+as\s*\$(\w+)(?:\s*\|\s*reverse)?\s*\}/,process:e=>({start:parseInt(e[2],10),end:parseInt(e[3],10),item:e[4],reverse:e[0].includes("| reverse")})},{type:"for",regex:/^\{(for|foreach)\s*\$(\w+(?:\.\w+)?)\s+as\s*\$(\w+)(?:\s*\|\s*reverse)?\s*\}/,process:e=>({collection:`$${e[2]}`,item:e[3],key:null,reverse:e[0].includes("| reverse")})},{type:"for",regex:/^\{(for|foreach)\s*\$(\w+(?:\.\w+)?)\s+as\s*\$(\w+)\s*=>\s*\$(\w+)(?:\s*\|\s*reverse)?\s*\}/,process:e=>({collection:`$${e[2]}`,key:e[3],item:e[4],reverse:e[0].includes("| reverse")})},{type:"endfor",regex:/^\{\/(?:for|foreach)\}/},{type:"break",regex:/^\{break\}/i},{type:"continue",regex:/^\{continue\}/i}],...[{type:"switch",regex:/^\{switch\s+(.+?)\}/,process:e=>({value:e[1].trim()})},{type:"case",regex:/^\{case\s+(.+?)\}/,process:e=>({value:e[1].trim()})},{type:"default",regex:/^\{default\}/},{type:"endswitch",regex:/^\{\/switch\}/}],{type:"operator",regex:/^\{\$(\w+)\s*(\+\+|--|\+=|-=|\*=|\/=|\%=)\s*([^}]+)?\}/,process:e=>{var t;return{variable:e[1],operator:e[2],value:(null==(t=e[3])?void 0:t.trim())||"1"}}},...[{type:"if",regex:/^\{if\s+(.+?)\}/,process:e=>({condition:e[1].trim()})},{type:"elseif",regex:/^\{elseif\s+(.+?)\}/,process:e=>({condition:e[1].trim()})},{type:"else",regex:/^\{else\}/},{type:"endif",regex:/^\{\/if\}/}],{type:"ignore_block",regex:/^\{ignore\}([\s\S]*?)\{\/ignore\}/,process:e=>({content:e[1]})},...[{type:"set",regex:/^\{set\s+\$(\w+)\s*=\s*(\{[^}]*\}|\[[^}]*\])\}/,process:e=>({variable:e[1],value:e[2]})},{type:"set",regex:/^\{set\s+\$(\w+)\s*=\s*(['"])(.*?)\2\}/,process:e=>({variable:e[1],value:e[3]})},{type:"set",regex:/^\{set\s+\$(\w+)\s*=\s*([^}\s][^}]*)\}/,process:e=>({variable:e[1],value:e[2].trim()})},{type:"add",regex:/^\{add\s+\$(\w+)\s*\+\+\}/,process:e=>({variable:e[1]})},{type:"var",regex:/^\{var\s+\$(\w+)\s*=\s*(['"])(.*?)\2\}/,process:e=>({variable:e[1],value:e[3]})}],...[{type:"unset",regex:/^\{unset\s+\$(\w+)\}/,process:e=>({variable:e[1]})},{type:"comment",regex:/^\{\*\s*([\s\S]*?)\s*\*\}/}],...[{type:"cycle",regex:/^\{cycle\s+(.+?)\}/,process:e=>({values:e[1]})}],...[{type:"filter",regex:/^\{filter\s+(.+?)\}/,process:e=>({filter:e[1].trim()})},{type:"endfilter",regex:/^\{\/filter\}/},{type:"raw",regex:/^\{raw\}/},{type:"endraw",regex:/^\{\/raw\}/},{type:"autoescape",regex:/^\{autoescape\}/},{type:"endautoescape",regex:/^\{\/autoescape\}/}],...[{type:"macro",regex:/^\{macro\s+(\w+)(?:\s*\((.*?)\))?\}/,process(e){const t=e[2]?e[2].split(",").map(e=>e.trim()):[];return{name:e[1],args:t}}},{type:"endmacro",regex:/^\{\/macro\}/},{type:"import",regex:/^\{import\s+(['"])(.*?)\1\s+as\s+(\w+)\}/,process:e=>({file:e[2],alias:e[3]})}],{type:"output",regex:/^\{output\s+name\s*=\s*(['"])(.*?)\1\s*\}/,process:e=>({name:e[2],filters:[]})},{type:"output",regex:/^\{output\s+(['"])(.*?)\1\s*\}/,process:e=>({name:e[2],filters:[]})},{type:"output",regex:/^\{output\s+([^\s}]+)\s*\}/,process:e=>({name:e[1],filters:[]})},{type:"output",regex:/^\{output\s+(\$?[^}]+)\}/,process:e=>({name:e[1].trim(),filters:[]})},{type:"output",regex:/^\{\$(.+?)\}/,process:e=>{const t=e[1].trim().split("|").map(e=>e.trim());return{name:`$${t[0]}`,filters:t.slice(1)}}},{type:"output",regex:/^\{([^$].+?)\}/,process:e=>({name:e[1].trim(),filters:[]})}];function s(e){const t=[];let s=0;for(;s<e.length;){let n=!1;if(e.slice(s).startsWith("{ignore}")){let r=1,o=s+8;for(;o<e.length;)if(e.length-o>=8&&e.startsWith("{ignore}",o))r++,o+=8;else if(e.length-o>=9&&e.startsWith("{/ignore}",o)){if(r--,o+=9,0===r){const r=e.slice(s+8,o-9);t.push({type:"text",value:r}),s=o,n=!0;break}}else o++;n||(t.push({type:"text",value:"{ignore}"}),s+=8);continue}if("{"!==e[s]){const r=e.indexOf("{",s);if(-1===r){t.push({type:"text",value:e.slice(s)});break}r>s&&t.push({type:"text",value:e.slice(s,r)}),s=r}for(const o of r){const r=e.slice(s).match(o.regex);if(r){const e={type:o.type,value:r[0]};if("comment"===o.type){s+=r[0].length,n=!0;break}o.process&&Object.assign(e,o.process(r)),t.push(e),s+=r[0].length,n=!0;break}}if(!n){const t=e.slice(s,s+30).replace(/\n/g,"↵");console.warn(`Skip unknown tag at ${s}: "${t}"`),s++}}return t}function n(e,t){const r={type:"if",condition:e[t].condition,body:[],elseIfs:[],elseBody:[]};let s=t+1,n=0;const o=[],a=[],c=[];let l=null,p=!1;for(;s<e.length;){const t=e[s];if("if"===t.type&&n++,"endif"===t.type){if(0===n)break;n--}if(n>0)l||p?l?l.tokens.push(t):p&&c.push(t):o.push(t),s++;else if("elseif"!==t.type)if("else"!==t.type){if("endif"===t.type)break;l||p?l?l.tokens.push(t):p&&c.push(t):o.push(t),s++}else l=null,p=!0,s++;else l||p?l?l.tokens.push(t):p&&c.push(t):(l={condition:t.condition,tokens:[]},a.push(l)),s++}return r.body=i(o),r.elseIfs=a.map(e=>({condition:e.condition,body:i(e.tokens)})),r.elseBody=i(c),{node:r,nextIndex:s+1}}function o(e,t){const r=e[t];let s;if("for_range"===r.type)s={type:"for_range",start:r.start,end:r.end,item:r.item,reverse:Boolean(r.reverse),body:[],elseBody:[]};else{if("for"!==r.type&&"foreach"!==r.type)throw new Error(`Invalid for token at ${t}: ${r.type}`);s={type:"for",collection:r.collection,item:r.item,key:r.key||null,reverse:Boolean(r.reverse),body:[],elseBody:[]}}let n=t+1,o=0,a=!1;const c=[],l=[];for(;n<e.length;){const t=e[n];if("for"!==t.type&&"foreach"!==t.type&&"for_range"!==t.type||o++,"endfor"===t.type||"endforeach"===t.type){if(!(o>0))break;o--}"foreachelse"!==t.type||0!==o?(a?l.push(t):c.push(t),n++):(a=!0,n++)}if(n>=e.length)throw new Error("Unclosed for loop: expected {/for}");return s.body=i(c),l.length>0&&(s.elseBody=i(l)),{node:s,nextIndex:n+1}}function a(e,t){const r={type:"switch",value:e[t].value,cases:[],defaultBody:[]};let s=t+1,n=0,o=null,a=!1;for(;s<e.length;){const t=e[s];if("switch"===t.type&&n++,"endswitch"===t.type){if(n>0){n--,o&&o.body.push(t),s++;continue}return{node:r,nextIndex:s+1}}if(n>0)o&&o.body.push(t),s++;else if("case"!==t.type)if("default"!==t.type)o?o.body.push(t):a?r.defaultBody.push(t):r.cases.length>0&&r.cases[r.cases.length-1].body.push(t),s++;else{if(a)throw new Error("Duplicate {default} in switch");a=!0,o=null,s++}else o={value:t.value,body:[]},r.cases.push(o),s++}throw new Error("Unclosed switch: expected {/switch}")}function i(e){const t=[];let r=0;for(;r<e.length;){const s=e[r];if("block_open"===s.type){const n=s.name;r++;const o=[];let a=0;for(;r<e.length;){const t=e[r];if("block_open"===t.type&&a++,"block_close"===t.type){if(0===a)break;a--}o.push(t),r++}const c=i(o);t.push({type:"block",name:n,body:c}),r++;continue}if("extends"!==s.type)if("include"!==s.type)if(["set","var","add"].includes(s.type))t.push({...s}),r++;else{if("if"===s.type){const{node:s,nextIndex:o}=n(e,r);t.push(s),r=o;continue}if(["for","foreach","for_range"].includes(s.type)){const{node:s,nextIndex:n}=o(e,r);t.push(s),r=n;continue}if("switch"===s.type){const{node:s,nextIndex:n}=a(e,r);t.push(s),r=n;continue}if("output"===s.type){const e=s.value.match(/^\{\$(.+)\}$/);if(!e){t.push({type:"text",value:s.value}),r++;continue}const n=e[1].trim().split("|"),o=n[0],a=n.slice(1);t.push({type:"output",name:`$${o}`,filters:a}),r++;continue}["elseif","else","endif","endfor","endforeach","endswitch"].includes(s.type)||t.push({...s}),r++}else t.push({...s}),r++;else t.push({...s}),r++}return t}function c(e){const t=function(e){const t=[],r=/(\s+|[$a-zA-Z_]\w*(?:\.\w+)*|"(?:[^"\\]|\\.)*"|'(?:[^'\\]|\\.)*'|\d+(?:\.\d+)?|[-+*/%<>=!&|?:(){}[\]~]+|[\w-]+:)/g;let s;const n=e=>["+","-","*","/","%","==","!=","<","<=",">",">=","&&","||","!","(",")","?",":","~"].includes(e);for(;null!==(s=r.exec(e));){const e=s[0].trim();if(e)if(n(e))t.push({type:"op",value:e});else if("|"===e)t.push({type:"filter",value:e});else if(e.startsWith("$"))t.push({type:"var",value:e});else if(/^["']/.test(e)){const r=e.slice(1,-1).replace(/\\(.)/g,"$1");t.push({type:"str",value:r})}else isNaN(+e)?t.push({type:"str",value:e}):t.push({type:"num",value:e})}return t}(e);let r=0;function s(){const e=o(()=>o(()=>o(()=>o(()=>o(()=>n(),["*","/","%"]),["+","-","~"]),["<","<=",">",">="]),["==","!="]),["||","&&"]);if(r<t.length&&"?"===t[r].value){r++;const n=s();r<t.length&&":"===t[r].value&&r++;return{type:"conditional",test:e,consequent:n,alternate:s()}}return e}function n(){if(r<t.length&&["!","+","-"].includes(t[r].value)){const e=t[r].value;return r++,{type:"unary",operator:e,argument:n()}}return function(){const e=t[r];if(!e)throw new Error("Unexpected end of expression");if("num"===e.type)return r++,{type:"literal",value:+e.value};if("str"===e.type)return r++,{type:"literal",value:e.value};if("var"===e.type)return r++,{type:"variable",path:e.value.slice(1)};if("("===e.value){r++;const e=s();if(r>=t.length||")"!==t[r].value)throw new Error("Expected )");return r++,e}throw new Error(`Unexpected token: ${e.value}`)}()}function o(e,s){let n=e();for(;r<t.length&&s.includes(t[r].value);){const s=t[r].value;r++;n={type:"binary",operator:s,left:n,right:e()}}return n}return s()}function l(e){if("true"===(e=e.trim()))return!0;if("false"===e)return!1;if("null"===e)return null;if("undefined"!==e){if(!isNaN(+e)&&!e.includes(" "))return+e;if(/^["'](.*)["']$/.test(e))return e.slice(1,-1);if(e.startsWith("[")&&e.endsWith("]"))try{return e.slice(1,-1).split(",").map(e=>e.trim()).map(l)}catch{}if(e.startsWith("{")&&e.endsWith("}"))try{return JSON.parse(e.replace(/(\w+):/g,'"$1":').replace(/'/g,'"'))}catch{}return e}}function p(e,t,r){return(...s)=>{const n=s[0];let o=!1;switch(t){case"array":o=Array.isArray(n);break;case"string":o="string"==typeof n;break;case"object":o=n&&"object"==typeof n&&!Array.isArray(n)}return o||console.warn(`[Fenom] filter '${e}' should be used with ${t}, but got ${typeof n}`),r(...s)}}function u(e,t){if(!e||"string"!=typeof e)return;const r=(e.startsWith("$")?e.slice(1):e).split(".").map(e=>e.trim());let s=t;for(const n of r){if(null==s||"object"!=typeof s)return;s=s[n]}return s}function f(e,t,r,s){let n=e;for(const a of t){const[e,...t]=a.split(":").map(e=>e.trim()),i=s[e];if("function"==typeof i){const e=t.map(e=>/^["'].*["']$/.test(e)?e.slice(1,-1):isNaN(+e)?e.startsWith("$")?u(e.slice(1),r)??"":e:+e);try{n=i(n,...e)}catch(o){n=""}}}return n}function y(e,t,r){switch(e.type){case"literal":return e.value;case"variable":return u(e.path,t)??"";case"unary":const s=y(e.argument,t,r);switch(e.operator){case"!":return!s;case"+":return+s;case"-":return-s}break;case"binary":{const s=y(e.left,t,r),n=y(e.right,t,r);switch(e.operator){case"+":return s+n;case"-":return s-n;case"*":return s*n;case"/":return s/n;case"%":return s%n;case"==":return s==n;case"!=":return s!=n;case"<":return s<n;case"<=":return s<=n;case">":return s>n;case">=":return s>=n;case"&&":return s&&n;case"||":return s||n;case"~":return String(s)+String(n)}break}case"conditional":const n=y(e.test,t,r);return y(n?e.consequent:e.alternate,t,r);case"filter":{const s=y(e.expression,t,r),n=e.args.map(e=>y(e,t,r)),o=r[e.filter];return"function"==typeof o?o(s,...n):s}}return""}async function g(e,t,r,n){var o,a;let p="";for(const h of e)switch(h.type){case"text":p+=h.value;break;case"ignore_block":p+=h.content||"";break;case"comment":case"extends":break;case"output":try{const e=h.name.trim();let t;if(/[+\-*/%<>!=&|?:~]/.test(e)){t=y(c(e),r,n)}else t=u(e,r)??"";const s=f(t,h.filters,r,n);p+=String(s)}catch(d){console.warn(`Eval error: ${h.name}`,d),p+=""}break;case"set":try{const e=h.value.trim();if(/[+\-*/%~]/.test(e)){const t=c(e);r[h.variable]=y(t,r,n)}else e.startsWith("$")?r[h.variable]=u(e,r)??"":r[h.variable]=l(e)}catch(d){r[h.variable]=""}break;case"var":void 0===r[h.variable]&&(r[h.variable]=l(h.value));break;case"add":r[h.variable]=(r[h.variable]||0)+1;break;case"if":{let e=!1;try{e=!!y(c(h.condition),r,n)}catch(d){console.warn(`Condition error: ${h.condition}`,d)}const s=e?h.body:(null==(a=null==(o=h.elseIfs)?void 0:o.find(e=>{try{return!!y(c(e.condition),r,n)}catch{return!1}}))?void 0:a.body)||h.elseBody||[];p+=await g(s,t,r,n);break}case"for_range":{const{start:e,end:s,item:o,reverse:a,body:i,elseBody:c}=h,l=[];for(let t=e;t<=s;t++)l.push(t);a&&l.reverse();let u="";if(0===l.length&&c)u+=await g(c,t,r,n);else for(const p of l){const c={...r};c[o]=p,c.loop={index:p-e+1,first:p===(a?s:e),last:p===(a?e:s),key:p-e},u+=await g(i,t,c,n)}p+=u;break}case"for":{const e=u(h.collection.startsWith("$")?h.collection.slice(1):h.collection,r);let s=[];if(Array.isArray(e)?s=Array.from(e.entries()):e&&"object"==typeof e&&(s=Object.entries(e)),h.reverse&&(s=s.reverse()),0===s.length&&h.elseBody)p+=await g(h.elseBody,t,r,n);else for(const[o,a]of s){const e={...r};e[h.item]=a,h.key&&(e[h.key]=o),e.loop={index:o+1,first:0===o,last:o===s.length-1,key:o},p+=await g(h.body,t,e,n)}break}case"block":"function"==typeof r.block&&(p+=await r.block(h.name));break;case"include":try{let e=h.file;"string"==typeof e&&(e=e.replace(/^['"]|['"]$/g,""));const o=await t(e),a=i(s(o)),c={...r};if(h.params)for(const[t,s]of Object.entries(h.params))"string"==typeof s&&s.startsWith("$")?c[t]=u(s,r)??"":c[t]=s;p+=await g(a,t,c,n)}catch(d){p+=`[Include error: ${h.file}]`}break;default:console.warn(`Unknown node type: ${h.type}`)}return p}function d(e,t){const r={};let n=null;for(const s of e)"extends"===s.type?n=s.file:"block"===s.type&&(r[s.name]=s.body);return n?async function(e,o){try{const a=await t(n),c=i(s(a)),l={};for(const e of c)"block"===e.type&&(l[e.name]=e.body);const p={...l,...r},u={};return e.block=async r=>{if(void 0!==u[r])return u[r];const s=p[r];return s?(u[r]=await g(s,t,e,o),u[r]):(u[r]="","")},await g(c,t,e,o)}catch(a){return`[Render error: ${a.message}]`}}:async function(r,s){return await g(e,t,r,s)}}function h(r){return async function(s){const n=e.join(r,s);if(!n.endsWith(".tpl"))throw new Error(`Template path must end with .tpl: ${s}`);try{return await t.readFile(n,"utf-8")}catch(o){if("ENOENT"===o.code)throw new Error(`Template not found: ${n}`);throw o}}}const m={upper:e=>String(e).toUpperCase(),lower:e=>String(e).toLowerCase(),capitalize:e=>{const t=String(e).trim();return 0===t.length?"":t.charAt(0).toUpperCase()+t.slice(1).toLowerCase()},ucfirst:e=>m.capitalize(e),ucwords:e=>String(e).trim().replace(/\b\w/g,e=>e.toUpperCase()),lcfirst:e=>{const t=String(e).trim();return 0===t.length?"":t.charAt(0).toLowerCase()+t.slice(1)},trim:e=>String(e).trim(),ltrim:e=>String(e).replace(/^\s+/,""),rtrim:e=>String(e).replace(/\s+$/,""),nl2br:e=>String(e).replace(/\n/g,"<br>"),replace:(e,t,r)=>String(e).split(String(t)).join(String(r)),substr:p("substr","string",(e,t,r)=>{const s=String(e);return void 0===r?s.slice(t):s.slice(t,t+r)}),urlencode:e=>encodeURIComponent(String(e)),urldecode:e=>decodeURIComponent(String(e)),escape:p("escape","string",e=>String(e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")),e:e=>m.escape(e),first:p("first","array",e=>Array.isArray(e)?e[0]:e&&"object"==typeof e?Object.values(e)[0]:""),last:p("last","array",e=>{if(Array.isArray(e))return e[e.length-1];if(e&&"object"==typeof e){const t=Object.values(e);return t[t.length-1]}return""}),join:p("join","array",(e,t=",")=>Array.isArray(e)?e.join(t):e&&"object"==typeof e?Object.values(e).join(t):String(e)),reverse:p("reverse","array",e=>Array.isArray(e)?[...e].reverse():e),sort:p("sort","array",e=>Array.isArray(e)?[...e].sort():e),ksort:p("ksort","object",e=>{if(e&&"object"==typeof e){const t={};return Object.keys(e).sort().forEach(r=>{t[r]=e[r]}),t}return e}),unique:p("unique","array",e=>Array.isArray(e)?[...new Set(e)]:e),shuffle:p("shuffle","array",e=>{if(!Array.isArray(e))return e;const t=[...e];for(let r=t.length-1;r>0;r--){const e=Math.floor(Math.random()*(r+1));[t[r],t[e]]=[t[e],t[r]]}return t}),slice:(e,t,r)=>Array.isArray(e)||"string"==typeof e?void 0===r?e.slice(t):e.slice(t,t+r):e,merge:(e,t)=>Array.isArray(e)&&Array.isArray(t)?[...e,...t]:e,batch:(e,t)=>{if(!Array.isArray(e))return e;const r=[];for(let s=0;s<e.length;s+=t)r.push(e.slice(s,s+t));return r},keys:e=>e&&"object"==typeof e?Object.keys(e):[],values:e=>e&&"object"==typeof e?Object.values(e):[],length:e=>Array.isArray(e)?e.length:e&&"object"==typeof e?Object.keys(e).length:String(e).length,number_format:(e,t=0,r=".",s=",")=>{const n=Number(e);return isNaN(n)?"":n.toLocaleString("en-US",{minimumFractionDigits:t,maximumFractionDigits:t,useGrouping:!0}).replace(/,/g,s).replace(/\./g,r)},abs:e=>Math.abs(Number(e)||0),round:(e,t=0)=>{const r=10**t;return Math.round((Number(e)||0)*r)/r},json_encode:e=>JSON.stringify(e),json_decode:e=>{try{return JSON.parse(String(e))}catch{return null}},date:(e,t="d.m.Y")=>{const r=Number(e),s=new Date(isNaN(r)?e:1e3*r);if(isNaN(s.getTime()))return console.warn(`[Fenom] filter 'date' received invalid timestamp: ${e}`),"";const n=e=>e.toString().padStart(2,"0");return t.replace(/d/g,n(s.getDate())).replace(/m/g,n(s.getMonth()+1)).replace(/Y/g,s.getFullYear().toString()).replace(/H/g,n(s.getHours())).replace(/i/g,n(s.getMinutes())).replace(/s/g,n(s.getSeconds()))},default:(e,t)=>null==e||""===e||"object"==typeof e&&0===Object.keys(e).length?t:e,raw:e=>e,var_dump:e=>`<pre>${JSON.stringify(e,null,2)}</pre>`,print_r:e=>`<pre>${e instanceof Object?JSON.stringify(e,null,2):String(e)}</pre>`};exports.FenomJs=async function(e,t={},r){const{root:n="./src/",loader:o,minify:a=!1}=r||{},c=o||h(n);try{const r=s(e),n=d(i(r),c),o=await n(t,m);return a?function(e){return e.replace(/>\s+</g,"><").replace(/\s{2,}/g," ").replace(/(<!--.*?-->)\s+/g,"$1").trim()}(o):o}catch(l){return console.error("Template error:",l),`<span style='color:red'>[Ошибка шаблона: ${l.message}]</span>`}},exports.compile=d,exports.createAsyncLoader=h,exports.parse=i,exports.tokenize=s;
